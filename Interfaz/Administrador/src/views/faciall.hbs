
    <header class="row" style="position: relative;  height: 30vh; width: 100%;" >
        <div
          class="col s12 m11 l9 xl8 "
          style="position: absolute; top: 0px; height: 60%; left: 0px;"
        >
          <img
            alt="imagen1"
            src="/img/rec5.png"
            class="responsive-image" 
            style="height: 200%; width: 100%; left: 0px; top: 0px; position: absolute; object-fit: cover;"
          />
        </div>
        <div class="col s12 m9 l9 xl8 white-text" 
             style="position: absolute; top: 50%; left: 30%; height: 100%; transform: translate(-50%, -50%); width: 50%;"
        >
        <br>
              <br>
            <blockquote>
              <br>
              <h2 class="subtitulo black-text ">
                <b>
                  Rostro <br /> 
                </b>
              </h2>
            </blockquote>
        </div>
        
        <div class="col m6 l6 xl5 hide-on-small-only" style="height: 100%; position: absolute; top: 0%; right: 0%;">
          <img alt="" src="/img/parteba10.png" 
          class="responsive-img" style="position: absolute; right: -5px; top: 0px; height: 100%; width: 70%;">
        </div>  
    </header>
      <br />
      <!--
      <br />
      -->
    
     

<div class="col-md-8 mx-auto">
  <div class="card">
    <div class="card-header bg-success text-center" style="--bs-bg-opacity: .7;">
      <h3 class="text-white">Captura el rostro
        <i class="material-icons small rounded-circle " style="font-size:40px;">face
        </i>
      </h3>
    </div>
    <div class="card-body text-left bg-success "style="--bs-bg-opacity: .3;">
      <div class="container">
          <div class="row ">
              <div class="col">
                  
                  <p class="text-black" style="font-family: 'Franklin Gothic Medium'; font-size: 20px;" > 
                    <b>Aquí se realiza la captura de rostro</b>
                  </p>
                  <br>
                  <p>
                    Al oprimir el boton de "Take Foto" se tomará una imagen de tu rostro, posterior a eso tendrás que oprimir el botón de aceptar para continuar con el registro.
                  </p>
                  <div class="row justify-content-md-center">
                    <div class="col-6 aling-self-center">
                    
                      <br>
                      <div id="my_camera"></div>
                      <br>
                      <div class="d-flex justify-content-center">
                        <button type="button" class="btn btn-primary" onclick="takeSnapshotAndSend()">Capturar</button>
                      </div>
                      <br>
                      
                      <!-- 
                      <input type=button value="Take Snapshot" onClick="take_snapshot()">  
                      -->
                      <div id="results" ></div>
                        
                      <!-- Webcam.min.js-->
                                  
                      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/webcamjs/1.0.25/webcam.min.js"></script> 
                                
                                <!-- Configure a few settings and attach camera -->
                               <!--  <script type="text/javascript" src="/biometricos/webcam.js"></script>
                                <script type="text/javascript" src="/biometricos/webcam.min.js"></script> -->
                      <!--   -->         
                     <script language="JavaScript">
                        Webcam.set({
                        width: 320,
                        height: 240,
                        image_format: 'jpeg',
                        jpeg_quality: 90
                        });
                        Webcam.attach( '#my_camera' );
                                  
                         <!-- Code to handle taking the snapshot and displaying it locally -->
                              
                         var numPhotos = 10; // Número total de fotos que se van a capturar
                        var photoCounter = 0; // Contador de fotos capturadas
                         <!--for (var i = 0; i <numPhotos; i++) {-->
                        function takeSnapshotAndSend() {
                            // Tomar la instantánea y obtener los datos de la imagen
                            Webcam.snap(function(data_uri) {
                               // display results in page
                            document.getElementById('results').innerHTML = 
                            '<img src="'+data_uri+'"/>';
                                // Crear un objeto FormData y agregar los datos de la imagen
                                var formData = new FormData();
                                formData.append('image', dataURItoBlob(data_uri), 'snapshot.png');

                                // Enviar los datos de la imagen al servidor
                                var xhr = new XMLHttpRequest();
                                xhr.open('POST', 'https://biometricsystem.hugedata.systems/Facial/', true);  // Ruta en el servidor para guardar la imagen
                                xhr.onreadystatechange = function() {
                                    if (xhr.readyState === 4 && xhr.status === 200) {
                                        console.log('La imagen se ha guardado correctamente.');

                                        // Incrementar el contador de fotos capturadas
                                        photoCounter++;

                                        // Verificar si se han capturado todas las fotos
                                        if (photoCounter < numPhotos) {
                                            // Si no se han capturado todas las fotos, tomar otra instantánea y enviarla
                                            takeSnapshotAndSend();
                                        } else {
                                            console.log('Se han capturado y enviado todas las fotos.');
                                        }
                                    }
                                };
                                xhr.send(formData);
                            });
                        

                        // Función auxiliar para convertir los datos de la imagen en un objeto Blob
                        function dataURItoBlob(dataURI) {
                            var byteString = atob(dataURI.split(',')[1]);
                            var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
                            var ab = new ArrayBuffer(byteString.length);
                            var ia = new Uint8Array(ab);
                            for (var i = 0; i < byteString.length; i++) {
                                ia[i] = byteString.charCodeAt(i);
                            }
                            return new Blob([ab], { type: mimeString });
                            console.log("Blob ", Blob)
                        }
                        }


                    </script>
                    </div>                   
                  </div>          
                    <br>
                    <!--Otro codigo pero solo muestra imagen
                     <div class="col-6 aling-self-center">
                      <video autoplay="true" id="videoElement">
                      </video>
                      <script src="/biometricos/stream.js" type="text/javascript">  </script>
                      <script>
                          var video = document.querySelector("#videoElement");
                          stream(video);
                      </script>
                     </div> 
                     -->
                    <br>
                                         
              </div>
          </div>
          <div class="row justify-content-end">
          <div class="col-4 align-self-end">
            <a class="waves-effect waves-light text-white btn p-2 text-center  " style="background: rgb(29, 240, 134);border-radius: 20px;"
                      href="javascript:window.history.back(); "
                  > Aceptar
                 <i class="material-icons small rounded-circle " style="font-size:20px;">face
                 </i>                  
            </a>
          </div>
      </div>
      </div>
    </div>
  </div>
</div>
<br>